<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crypto View</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="header-left">
                <h1 class="header-title">Crypto View</h1>
                <h1 class="header-subtitle">Live Crypto Price Analytics</h1>
            </div>
            <div class="header-right">
                <div class="current-time" id="currentTime">Fetching</div>
                <div class="connection-status" id="connectionStatus">
                    <span class="status-dot"></span>
                    <span class="status-text">Connecting...</span>
                </div>
            </div>
        </div>
        <div id="restoreModeIndicator" style="display: none;" class="panel">
            <div class="anomaly-item status--warning">

                <span class="anomaly-text" id="restoreModeText">RESTORED FROM SNAPSHOT — LIVE DATA DISABLED</span>
                <button id="exitRestoreModeBtn" style="margin-left: auto; padding: 4px 12px; background: var(--color-surface); border: 1px solid var(--color-border); border-radius: var(--radius-base); cursor: pointer; font-size: var(--font-size-sm);">Exit Restore Mode</button>
            </div>
        </div>
    </header>
    <div class="footer-wrap"></div>

    <!-- Main Container -->
    <main class="main-container">

        <!-- Crypto Selector -->
        <section class="crypto-selector">
            <button class="crypto-btn active" data-symbol="BTC" data-name="Bitcoin" data-icon="₿">
                <span class="crypto-icon">₿</span>
                <span class="crypto-name">BTC</span>
            </button>
            <button class="crypto-btn" data-symbol="ETH" data-name="Ethereum" data-icon="Ξ">
                <span class="crypto-icon">Ξ</span>
                <span class="crypto-name">ETH</span>
            </button>
            <button class="crypto-btn" data-symbol="ADA" data-name="Cardano" data-icon="₳">
                <span class="crypto-icon">₳</span>
                <span class="crypto-name">ADA</span>
            </button>
            <button class="crypto-btn" data-symbol="DOT" data-name="Polkadot" data-icon="●">
                <span class="crypto-icon">●</span>
                <span class="crypto-name">DOT</span>
            </button>
            <button class="crypto-btn" data-symbol="SOL" data-name="Solana" data-icon="◎">
                <span class="crypto-icon">◎</span>
                <span class="crypto-name">SOL</span>
            </button>
            <button class="crypto-btn" data-symbol="BNB" data-name="Binance Coin" data-icon="⬢">
                <span class="crypto-icon">⬢</span>
                <span class="crypto-name">BNB</span>
            </button>
            <button class="crypto-btn" data-symbol="XRP" data-name="Ripple" data-icon="✕">
                <span class="crypto-icon">✕</span>
                <span class="crypto-name">XRP</span>
            </button>
            <button class="crypto-btn" data-symbol="DOGE" data-name="Dogecoin" data-icon="Ð">
                <span class="crypto-icon">Ð</span>
                <span class="crypto-name">DOGE</span>
            </button>
            <button class="crypto-btn" data-symbol="LTC" data-name="Litecoin" data-icon="Ł">
                <span class="crypto-icon">Ł</span>
                <span class="crypto-name">LTC</span>
            </button>
        </section>

        <!-- Current Price Card -->
        <section class="price-card">
            <div class="price-card-header">
                <div class="price-crypto-info">
                    <span class="price-crypto-icon" id="priceIcon">₿</span>
                    <div>
                        <h2 class="price-crypto-name" id="priceCryptoName">Bitcoin</h2>
                        <span class="price-crypto-symbol" id="priceCryptoSymbol">BTC/USDT</span>
                    </div>
                </div>
            </div>
            <div class="price-card-body">
                <div class="current-price-container">
                    <span class="price-arrow" id="priceArrow">→</span>
                    <div class="current-price" id="currentPrice">$--,---</div>
                </div>
                <div class="price-change" id="priceChange">
                    <span class="change-value">+0.00%</span>
                    <span class="change-amount">$0.00</span>
                </div>
            </div>
            <div class="price-stats">
                <div class="stat-item">
                    <span class="stat-label">24h High</span>
                    <span class="stat-value" id="high24h">$--,---</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">24h Low</span>
                    <span class="stat-value" id="low24h">$--,---</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">24h Volume</span>
                    <span class="stat-value" id="volume24h">--</span>
                </div>
            </div>
        </section>

        <!-- Market Microstructure Panel -->
        <section class="panel">
            <h3 class="panel-title">Market Microstructure</h3>
            <div class="microstructure-grid">
                <div class="metric-card">
                    <div class="metric-label">Order Flow Imbalance</div>
                    <div class="metric-value" id="ofiValue">--</div>
                    <div class="metric-bar">
                        <div class="metric-bar-fill" id="ofiBar"></div>
                    </div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Volume Slope</div>
                    <div class="metric-value" id="volumeSlope">--</div>
                    <div class="metric-bar">
                        <div class="metric-bar-fill" id="volumeSlopeBar"></div>
                    </div>
                </div>
                <div class="metric-card">
                    <div class="metric-label">Bid-Ask Imbalance</div>
                    <div class="metric-value" id="bidAskImbalance">--</div>
                    <div class="metric-bar">
                        <div class="metric-bar-fill" id="bidAskBar"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Volatility Metrics -->
        <section class="panel">
            <h3 class="panel-title">Volatility Metrics</h3>
            <div class="volatility-grid">
                <div class="volatility-item">
                    <div class="volatility-header">
                        <span class="volatility-label">1h Volatility</span>
                        <span class="volatility-value" id="vol1h">--%</span>
                    </div>
                    <div class="volatility-gauge">
                        <div class="gauge-fill" id="vol1hGauge"></div>
                    </div>
                </div>
                <div class="volatility-item">
                    <div class="volatility-header">
                        <span class="volatility-label">4h Volatility</span>
                        <span class="volatility-value" id="vol4h">--%</span>
                    </div>
                    <div class="volatility-gauge">
                        <div class="gauge-fill" id="vol4hGauge"></div>
                    </div>
                </div>
                <div class="volatility-item">
                    <div class="volatility-header">
                        <span class="volatility-label">24h Volatility</span>
                        <span class="volatility-value" id="vol24h">--%</span>
                    </div>
                    <div class="volatility-gauge">
                        <div class="gauge-fill" id="vol24hGauge"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Anomaly Detection -->
        <section class="panel">
            <h3 class="panel-title">Anomaly Detection</h3>
            <div class="anomaly-container" id="anomalyContainer">
                <div class="anomaly-item status--info">
                    <span class="anomaly-icon">ℹ️</span>
                    <span class="anomaly-text">Monitoring market conditions...</span>
                </div>
            </div>
        </section>

        <!-- New Two-Column Layout -->
        <div class="stats-grid">
            <!-- LEFT: TOP MOVERS -->
            <div class="stats-card">
                <h3>Top Movers</h3>
                <div id="top-movers"></div>
            </div>

            <!-- RIGHT: RISK INDICATORS -->
            <div class="stats-card">
                <h3>Risk Indicators</h3>
                <div class="risk-item">
                    <span>Volatility</span>
                    <div class="risk-bar">
                        <div id="bar-volatility"></div>
                    </div>
                </div>
                <div class="risk-item">
                    <span>Whale Activity</span>
                    <div class="risk-bar">
                        <div id="bar-whale"></div>
                    </div>
                </div>
                <div class="risk-item">
                    <span>Unusual Volume</span>
                    <div class="risk-bar">
                        <div id="bar-volume"></div>
                    </div>
                </div>
                <div class="risk-item">
                    <span>Price Deviation</span>
                    <div class="risk-bar">
                        <div id="bar-deviation"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Alert Center -->
        <section class="panel">
            <h3 class="panel-title">Alert Center</h3>
            <div class="alerts-container" id="alertsContainer">
                <div class="alert-item status--info">
                    <span class="alert-time">--:--</span>
                    <span class="alert-message">System initialized</span>
                </div>
            </div>
        </section>



        <!-- Floating Action Button Stack -->
        <div class="fab-stack">



            <!-- Search -->
            <button class="fab child" id="searchBtn" aria-label="Search">
        <span class="fab-icon">⌕</span>
        <span class="fab-tooltip">Search assets, metrics, and analytics</span>
    </button>
            <!-- Theme Toggle -->
            <button class="fab child" id="themeToggle" aria-label="Theme Toggle">
        <span class="fab-icon">◐</span>
        <span class="fab-tooltip">Switch between light and dark mode</span>
    </button>




            <!-- Import Snapshot -->
            <button class="fab child" id="importBtn" aria-label="Import Snapshot">
   <span class="fab-icon">
    <img src="monitoring.png" alt="AI Summary">
  </span>
        <span class="fab-tooltip">Import and restore a saved market snapshot</span>
    </button>
            <!-- Export Data -->
            <button class="fab child" id="exportBtn" aria-label="Export Snapshot">
        <span class="fab-icon">⭳</span>
        <span class="fab-tooltip">Export current market snapshot (PDF / JSON)</span>
    </button>
            <div class="export-dropdown" id="exportDropdown">
                <div class="export-option" data-option="pdf">Export as PDF</div>
                <div class="export-option" data-option="json">Export as JSON</div>
                <div class="export-option" data-option="both">Export as BOTH</div>
                <div class="export-option" data-option="cancel">Cancel</div>
            </div>
            <button class="fab child" id="aiSummaryBtn" aria-label="AI Summary">
  <span class="fab-icon">
    <img src="artificial-intelligence.png" alt="AI Summary">
  </span>
  <span class="fab-tooltip">Generate AI-powered market summary</span>
</button>

            <!-- Currency Toggle -->
            <button class="fab child" id="currencyToggle" aria-label="Currency Toggle">
        <span class="fab-icon">₹ / $</span>
        <span class="fab-tooltip">Toggle price display between INR and USDT</span>
    </button>

            <button class="fab main" aria-label="Actions">
  <span class="fab-icon">
    <img src="outdent.png" alt="Actions">
  </span>
</button>



        </div>


        <div id="aiSummaryPanel" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.45);z-index:9999;">

            <div id="aiSummaryWindow" style="
        width:520px;
        max-width:90vw;
        min-width:320px;
        min-height:220px;
        background:var(--color-surface);
        border-radius:14px;
        box-shadow:var(--shadow-lg);
        position:absolute;
        top:15%;
        left:50%;
        transform:translateX(-50%);
        resize:both;
        overflow:auto;
       ">

                <!-- HEADER (DRAG HANDLE) -->
                <div id="aiSummaryHeader" style="
          display:flex;
          align-items:center;
          justify-content:space-between;
          padding:12px 16px;
          border-bottom:1px solid var(--color-border);
          cursor:move;
         ">
                    <div style="display:flex;align-items:center;gap:8px;">
                        <span class="fab-icon2">
    <img src="artificial-intelligence.png" alt="AI Summary">
  </span>
                        <strong>AI Market Summary</strong>
                    </div>
                    <button onclick="closeAISummary()" style="background:none;border:none;font-size:16px;cursor:pointer;">
        ✕
      </button>
                </div>

                <!-- CONTENT -->
                <div style="padding:16px;">
                    <p id="aiSummaryText" style="
          line-height:1.6;
          font-size:14px;
          color:var(--color-text);
          margin-bottom:12px;
         ">
                        Generating AI summary…
                    </p>

                    <!-- STATUS -->
                    <div id="aiSummaryStatus" style="
            font-size:12px;
            color:var(--color-text-secondary);
            margin-bottom:12px;
           ">
                        Source: Snapshot-Based AI Analysis
                    </div>

                    <!-- ACTION BAR -->
                    <div style="
            display:flex;
            flex-wrap:wrap;
            gap:8px;
            justify-content:flex-end;
           ">

                        <button onclick="copyAISummary()" class="ai-btn">⧉ Copy</button>
                        <button onclick="shareAISummary()" class="ai-btn">⇪ Share</button>
                        <button onclick="downloadAISummary()" class="ai-btn">⇩ Download</button>

                    </div>
                </div>
            </div>
        </div>



        <!-- Hidden file input for import -->
        <input type="file" id="importFileInput" accept=".json" style="display: none;">

        <!-- Search Panel -->
        <div class="search-panel" id="searchPanel">
            <div class="search-panel-header">
                <h3>Crypto Search</h3>
                <button class="close-btn" id="closeSearch">✕</button>
            </div>
            <input type="text" class="search-input" id="searchInput" placeholder="Search cryptocurrencies and metrics...">
            <div class="search-results" id="searchResults">
                <div class="search-result-item">Start typing to search...</div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="footer">
            <div class="footer-content">
                <div class="footer-item">
                    <span class="footer-label">Connection</span>
                    <span class="footer-value" id="footerConnection">Active</span>
                </div>
                <div class="footer-item">
                    <span class="footer-label">Latency</span>
                    <span class="footer-value" id="latency">--ms</span>
                </div>
                <div class="footer-item">
                    <span class="footer-label">Data Points</span>
                    <span class="footer-value" id="dataPoints">0</span>
                </div>
                <div class="footer-item" id="footerLivePriceBox" style="display:none;">
                    <span class="footer-value" id="footerLivePrice" style="font-size:30px; font-weight:1500;">$--</span>
                </div>
            </div>
        </footer>

        <!-- Copyright Footer -->
        <footer style="margin-top: var(--space-24); padding: var(--space-24); background: var(--color-surface); border-radius: var(--radius-lg); border: 1px solid var(--color-card-border); text-align: center;" role="contentinfo" aria-label="Footer information">
            <!-- Top Grid Section -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: var(--space-24); margin-bottom: var(--space-16);">
                <!-- Domains & Technologies -->
                <div>
                    <h4 style="font-size: var(--font-size-sm); font-weight: var(--font-weight-bold); margin-bottom: var(--space-8); color: var(--color-text);">
                        Domains & Technologies
                    </h4>
                    <div style="display: flex; flex-direction: column; gap: var(--space-4);">
                        <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">FinTech & Crypto Markets</span>
                        <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Data Analytics & Visualization</span>
                        <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Real-Time WebSocket Streaming</span>
                        <span style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Flat icon | JsPdf | JSRE</span>
                    </div>
                </div>
                <!-- Status -->
                <div>
                    <h4 style="font-size: var(--font-size-sm); font-weight: var(--font-weight-bold); margin-bottom: var(--space-8); color: var(--color-text);">
                        Status
                    </h4>
                    <div style="display: flex; flex-direction: column; gap: var(--space-4);">
                        <div style="font-size: var(--font-size-sm);">
                            Proxy:
                            <a href="https://crypto-ai-proxy.ajithramesh2020.workers.dev" target="_blank" rel="noopener noreferrer" style="color: var(--color-success); font-weight: var(--font-weight-bold); text-decoration: none;">
                                <span id="footerStatus">Cloudflare</span>
                            </a>
                        </div>

                        <div style="font-size: var(--font-size-sm);">Status: <span id="footerStatus" style="color: var(--color-success); font-weight: var(--font-weight-bold);">Live</span></div>
                        <div style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Built with real-time market data</div>
                        <div style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">Not financial advice</div>

                    </div>
                </div>
                <!-- APIs -->
                <div>
                    <h4 style="font-size: var(--font-size-sm); font-weight: var(--font-weight-bold); margin-bottom: var(--space-8); color: var(--color-text);">
                        APIs
                    </h4>
                    <div style="display: flex; flex-direction: column; gap: var(--space-4);">
                        <a href="https://www.binance.com/en/binance-api" style="font-size: var(--font-size-sm); color: var(--color-text-secondary); text-decoration: none;" target="_blank">Binance</a>
                        <a href="https://www.coingecko.com/en/api" style="font-size: var(--font-size-sm); color: var(--color-text-secondary); text-decoration: none;" target="_blank">CoinGecko</a>
                        <a href="https://www.exchangerate-api.com/" style="font-size: var(--font-size-sm); color: var(--color-text-secondary); text-decoration: none;" target="_blank">Exchange Rate</a>
                        <a href="https://www.huggingfaceapi.com/" style="font-size: var(--font-size-sm); color: var(--color-text-secondary); text-decoration: none;" target="_blank">HuggingFace</a>
                    </div>
                </div>


            </div>

            <div style="padding-top: var(--space-16); border-top: 1px solid var(--color-card-border-inner); padding-bottom: 0;">
                <a href="https://github.com/Ajith-data-analyst/crypto_view/blob/main/LICENSE.txt" style="font-size: var(--font-size-sm); color: var(--color-text-secondary); text-decoration: none; margin: 0; text-align: center; display: block;">
                © 2025 Crypto View | All rights reserved | Live Crypto Price Analytics
            </a>
            </div>
        </footer>

        <!-- JSON Decision Modal (required for JSRE) -->
        <div id="jsonDecisionModal" class="json-modal" style="display: none;">
            <div class="json-modal-backdrop"></div>
            <div class="json-modal-window">
                <h2 id="jsonModalTitle"></h2>
                <p id="jsonModalDesc"></p>
                <div id="jsonModalTimer" class="json-modal-timer"></div>
                <div class="json-modal-actions">
                    <button id="jsonPrimaryBtn" class="primary-btn"></button>
                    <button id="jsonSecondaryBtn" class="secondary-btn"></button>
                </div>
            </div>
        </div>

        <script src="app.js"></script>
</body>
<script>
    document.getElementById("aiSummaryBtn").onclick = () => {
        openAISummary("Generating AI summary…");
    };

    function copyAISummary() {
        const text = document.getElementById("aiSummaryText").innerText;
        navigator.clipboard.writeText(text);
        addAlert("AI summary copied", "success");
    }

    function shareAISummary() {
        const text = document.getElementById("aiSummaryText").innerText;

        if (navigator.share) {
            navigator.share({
                title: "Crypto View – AI Summary",
                text: text
            });
        } else {
            addAlert("Share not supported on this browser", "warning");
        }
    }

    function downloadAISummary() {
        const text = document.getElementById("aiSummaryText").innerText;
        const blob = new Blob([text], {
            type: "text/plain"
        });
        const url = URL.createObjectURL(blob);

        const a = document.createElement("a");
        a.href = url;
        a.download = `crypto-view-ai-summary-${Date.now()}.txt`;
        a.click();

        URL.revokeObjectURL(url);
    }

    function regenerateAISummary() {
        document.getElementById("aiSummaryText").innerText = "Regenerating summary…";
        generateAISummary();
    }
    (function makeAISummaryDraggable() {
        const panel = document.getElementById("aiSummaryWindow");
        const header = document.getElementById("aiSummaryHeader");

        let isDragging = false;
        let offsetX = 0;
        let offsetY = 0;

        header.addEventListener("mousedown", (e) => {
            isDragging = true;
            offsetX = e.clientX - panel.offsetLeft;
            offsetY = e.clientY - panel.offsetTop;
            document.body.style.userSelect = "none";
        });

        document.addEventListener("mousemove", (e) => {
            if (!isDragging) return;
            panel.style.margin = "0";
            panel.style.left = `${e.clientX - offsetX}px`;
            panel.style.top = `${e.clientY - offsetY}px`;
            panel.style.position = "absolute";
        });

        document.addEventListener("mouseup", () => {
            isDragging = false;
            document.body.style.userSelect = "";
        });
    })();
    resize: both;
    overflow: auto;
</script>

</html>